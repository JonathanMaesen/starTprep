<%- include('./partials/head') %>
  <script src="/scripts/menu.js" defer></script>

  <body class="menu">

    <!-- ─── Sidebar: Chair navigation ─────────────────────────── -->
    <aside class="sidebar">
      <h1 class="nav-btn" style="cursor:default">tafel: <%= table.follownummer %>
      </h1>
      <section class="stool-list" id="stoolContainer">
        <% for (let i=0; i < table.amount; i++) { %>
          <button class="nav-btn stool-btn" id="chair-<%= i + 1 %>">
            <%= i + 1 %>
          </button>
          <% } %>
      </section>

      </section>

      <form action="/menu/<%= table.follownummer %>/addChair" method="post">
        <button type="submit" class="btn nav-btn">
          Stoel Toevoegen
        </button>
      </form>
      <a href="/foh" class="btn nav-btn">Terug</a>
    </aside>

    <!-- ─── Main menu grid ───────────────────────────────────── -->
    <main class="menu-container">
      <nav id="menu-buttons">
        <h1 class="nav-btn" style="cursor: default;">Menu</h1>
        <% for( let i=0; i < dishmaster.categoryMaster.length; i++ ) { %>
          <button class="nav-btn">
            <%= dishmaster.categoryMaster[i] %>
          </button>
          <% } %>
      </nav>

      <section class="grid-container" id="menuContainer">
          <% for (let i=0; i < dishes.length; i++) { %>
            <form action="/menu/<%= table.follownummer %>/addDish/<%= dishes[i].name %>" method="post"
              >
              <button type="submit" class="grid-item nav-btn">
                <%= dishes[i].name %>
              </button>
            </form>
            <% } %>
      </section>
    </main>

    <!-- ─── Ticket panel ─────────────────────────────────────── -->
    <section class="ticket-panel ticketContainer" id="ticketContainer">
      <h1 class="" style="padding: 2rem;">TICKET</h1>
      <% if (banner) { %>
        <div class="alert alert-<%= banner.type === 'error' ? 'danger' : 'success' %>">
          <%= banner.msg %>
        </div>
        <% } %>
          <% for( let i=0; i < table.amount; i++ ) { %>
            <% const entry=ticket.chairAndDish.find(c=> c.chair === i + 1) || { dish: [] }; %>
              <div class="ticket-item">
                <h2>
                  <%= i + 1%>
                </h2>
                <% for (let j=0; j < entry.dish.length; j++) { %>
                  <p>
                    <%= entry.dish[j].name %>
                  </p>
                  <% } %>

                    <form action="/menu/<%= table.follownummer %>/addDish" method="post">
                      <button type="submit" class="btn nav-btn">
                        VERWIJDEREN
                      </button>
                    </form>
                    </article>
                    <% } %>
                      <div class="ticket-nav" style="padding: 2rem;">
                        <form action="/menu/<%= table.follownummer %>/addDish" method="post">
                          <button type="submit" class="btn nav-btn">
                            versturen
                          </button>
                        </form>
                      </div>
    </section>

    <!-- ─── Modifier modal ──────────────────────────────────── -->
    <section class="mod-menu modMenuItemWrapper" id="modMenu" style="display:none">
      <h3 id="modItemTitle"></h3>

      <div class="central-wrapper">
        <section>
          <h2>Notes</h2>
          <textarea id="modMenuNotes" placeholder="Notes"></textarea>
        </section>
        <section>
          <h2>Supplementen</h2>
          <form id="modMenuSupplement"></form>
        </section>
      </div>

      <div class="bottom-nav bottomNav">
        <button class="nav-btn" id="cancelModifications">Cancel</button>
        <button class="nav-btn" id="modItemAllergenBtn">Allergens</button>
        <button class="nav-btn" id="saveModifications">Save</button>
      </div>
    </section>

    <%- include('./partials/footer') %>
  </body>